# SNSプロフィール確認システム - デモ

## 概要

このデモは、UserQueryServiceを使ったSNSプロフィール確認機能を実装したものです。サンプルデータの中の一人のユーザーとしてログインしている状態をシミュレーションし、フォロー/フォロワー関係、ブロック関係が正しく見れるかを確認できます。

## 機能

### 🔍 プロフィール確認機能
- **自分のプロフィール表示**: ログイン中のユーザーの基本情報と統計を表示
- **他のユーザーのプロフィール表示**: 他のユーザーとの関係性（フォロー、ブロック、購読）を表示

### 👥 関係性一覧表示
- **フォロー中ユーザー一覧**: 自分がフォローしているユーザーの一覧
- **フォロワー一覧**: 自分をフォローしているユーザーの一覧
- **ブロック中ユーザー一覧**: 自分がブロックしているユーザーの一覧
- **ブロックしているユーザー一覧**: 自分をブロックしているユーザーの一覧
- **購読中ユーザー一覧**: 自分が購読しているユーザーの一覧
- **購読者一覧**: 自分を購読しているユーザーの一覧

## サンプルデータ

デモで使用されるサンプルユーザーは以下の6人です：

| ID | ユーザー名 | 表示名 | 説明 |
|----|------------|--------|------|
| 1 | hero_user | 勇者 | 世界を救う勇者 |
| 2 | mage_user | 魔法使い | 魔法の研究に没頭 |
| 3 | warrior_user | 戦士 | 剣の修行に励んでいる |
| 4 | thief_user | 盗賊 | 宝探しが趣味 |
| 5 | priest_user | 僧侶 | 人々を癒すのが使命 |
| 6 | merchant_user | 商人 | 良い取引を探している |

## 関係性の例

### 勇者（ID: 1）の関係性
- **フォロー中**: 魔法使い、戦士
- **フォロワー**: 魔法使い、戦士、盗賊、僧侶
- **ブロック中**: なし
- **ブロックされている**: 商人
- **購読中**: 魔法使い
- **購読者**: 魔法使い、僧侶

## 実行方法

### 自動テストデモ
すべての機能を順番に実行して結果を表示します。

```bash
cd /Users/minagawa/Research/llm_trpg_project/ai_rpg_world
source venv/bin/activate
python demos/sns/demo_sns_auto_test.py
```

### 対話型デモ（開発中）
将来的には、対話的に機能を操作できるようにする予定です。

```bash
cd /Users/minagawa/Research/llm_trpg_project/ai_rpg_world
source venv/bin/activate
python demos/sns/demo_sns_profile_system.py
```

## アーキテクチャ

このデモは、DDD（ドメイン駆動設計）の原則に基づいて実装されています。

### レイヤー構造
- **ドメイン層**: ビジネスロジックとエンティティ（UserAggregate, UserRepository）
- **アプリケーション層**: ユースケースの調整（UserQueryService）
- **インフラ層**: データアクセス（InMemorySnsUserRepository）
- **プレゼンテーション層**: ユーザーインターフェース（デモスクリプト）

### 主要コンポーネント

#### InMemorySnsUserRepository
- メモリベースのリポジトリ実装
- サンプルデータをセットアップ
- UserRepositoryインターフェースを実装

#### UserQueryService
- プロフィール確認のユースケースを調整
- ドメイン例外をアプリケーション例外に変換
- エラーハンドリングとログ出力

#### UserAggregate
- ユーザーエンティティ
- フォロー、ブロック、購読のビジネスロジックを実装
- 関係性の計算

## テスト

デモでは、UserQueryServiceのテストも実行済みです。テストは以下の機能を検証しています：

- 正常系：各機能が期待通りに動作すること
- 異常系：無効な入力や存在しないユーザーに対するエラー処理
- エッジケース：空のリスト、相互関係、特殊な関係性

## 実行結果の確認

自動テストを実行すると、以下の情報が確認できます：

1. **自分のプロフィール**: 基本情報と統計
2. **他のユーザーのプロフィール**: 関係性情報付き
3. **フォロー関係**: 相互フォロー、片方向フォローの確認
4. **ブロック関係**: ブロックの有無の確認
5. **購読関係**: 購読の有無の確認

## カスタマイズ

### ログイン状態の変更
デモでは、勇者（ID: 1）としてログインしていますが、他のユーザーとしてログイン状態を変更したい場合は、ソースコード内の`current_user_id`を変更してください。

### サンプルデータの変更
InMemorySnsUserRepositoryの`_setup_sample_data()`メソッドを編集することで、サンプルデータを変更できます。

## 注意事項

- このデモは開発・テスト目的で作成されたものです
- 実際のSNSシステムでは、認証・認可、セキュリティ、データ永続化などの考慮が必要です
- デモの実行にはPython 3.10以上が必要です

## 拡張性

このデモは以下のように拡張可能です：

- 投稿機能の追加
- メッセージ機能の追加
- リアクティブ機能の追加
- データベース統合
- APIエンドポイントの作成

## ライセンス

このデモは学習・教育目的で作成されたものです。実際のサービスへの使用は自己責任でお願いします。
